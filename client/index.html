<!doctype html>
<html lang="en" ng-app="application">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <title>Brigade UI</title>

  <base href="/brigade-ui/">

  <link href="assets/css/app.css" rel="stylesheet" type="text/css">
  <link rel="icon" type="image/png" href="assets/images/favicon.png">
  <link rel="icon" type="image/x-icon" href="assets/images/favicon.png">
  <link rel="apple-touch-icon-precomposed" href="assets/images/apple-touch-icon-precomposed.png">

  <script src="assets/js/foundation.js"></script>
  <script src="assets/js/templates.js"></script>
  <script src="assets/js/routes.js"></script>
  <script src="assets/js/app.js"></script>
</head>

<body>

  <div class="grid-frame">

    <div position="left" id="primary" class="vertical shrink grid-block">
      <a href="/brigade-ui/" class="logo"><img src="assets/images/brigade-logo.png" /></a>

      <a href="https://github.com/azure/brigade/tree/master/docs"><i class="icon ion-document-text right"></i></a>
      <a href="https://github.com/azure/brigade/issues"><i class="icon ion-help right"></i></a>
    </div>

    <!-- left sidebar -->
    <div zf-panel position="left" id="sidebar" class="medium-grid-block collapse medium-2 large-2 vertical" ng-hide="$state.current.name === 'home'" ng-init="projectID={{project.id}}">
      <div class="grid-content collapse shrink">
        <ul class="menu-bar primary">
          <li id="organization" ng-controller="projectController">
            <a href="" zf-popup-toggle="switcher">
              <h2>{{ $stateParams | trim }}</h2>
              <h3>Azure Container Service</h3>

              <i class="icon ion-chevron-down right"></i>
            </a>

            <zf-popup id="switcher" class="switcher-wrap">
              <small>Team</small>
              <select class="small-12">
                <option>Azure Container Service</option>
                <option>Deis</option>
              </select>
              <small>Project</small>
              <ul class="block-list" id="switcher-project" ng-controller="projectsController">
                <li ng-repeat="project in projects"><a href="../brigade-ui/#!/project/{{project.id}}">{{project.name}}</a></li>
              </ul>
            </zf-popup>
          </li>
        </ul>
      </div>
      <div class="grid-content">
        <nav>
          <ul>
            <li ng-class="{ 'active': $state.current.name === 'project'}">
              <a href="../brigade-ui/#!/project/{{ $stateParams.id }}">Activity</a>
            </li>
            <li ng-class="{ 'active': $state.current.name === 'build'}">
              <a href="../brigade-ui/#!/project/{{ $stateParams.id }}/{{build.id}}">Builds</a>

              <ul>
                <li class="active"><a>All</a></li>
                <li><a>Deploys</a></li>
                <li><a>Pulls</a></li>
                <li><a>Pushes</a></li>
                <li><a>Releases</a></li>
                <li><a>Tests</a></li>
              </ul>
            </li>
            <li><a href="../brigade-ui/#!/project/{{project.id}}">Pipelines</a></li>
            <li><a zf-open="basicModal">Configuration</a></li>
            <li><a href="../brigade-ui/#!/project/{{project.id}}">Speed</a></li>
          </ul>
        </nav>
      </div>
      <div class="grid-content collapse shrink avatar-section">
        <nav>
          <ul>
            <li><a href="https://github.com/azure/brigade/tree/master/docs" target="_blank">
              Docs
            </a></li>
            <li><a href="https://github.com/azure/brigade/issues/" target="_blank">
              Support
            </a></li>
          </ul>
        </nav>
      </div>
    </div>

    <!-- topbar #header -->
    <div class="grid-block collapse vertical">
      <div id="header" class="shrink collapse grid-content">
        <div class="menu-group primary">
          <div class="menu-group-left">
            <ul class="menu-bar">
              <li 
                ng-controller="projectController" 
                ng-hide="$state.current.name === 'home'">
                <a href="../brigade-ui/#!/project/{{project.id}}">{{project.name}}</a></li>
              <li 
                ng-controller="buildController" 
                ng-class="{ 'active': $state.current.name === 'project'}" 
                ng-hide="$state.current.name === 'home'">
                <a href="../brigade-ui/#!/project">Master</a></li>
              <li ng-show="$state.current.name === 'build'"><a href="/#!/build/{{build.id}}">Build {{ $stateParams.build.id}}</a></li>
            </ul>
          </div>
          <div class="menu-group-right">
            <ul class="icon-right menu-bar">
              <li>
                <a href="" zf-popup-toggle="account-menu">
                  <i class="icon ion-person rounded right"></i>
                  <small>
                    <i class="icon ion-chevron-down right"></i>
                  </small>
                </a>

                <zf-popup id="account-menu" class="account-dropdown">
                  <ul class="block-list">
                    <li class="account-user">
                      <small>Logged in as:</small>
                      <strong>roflynnc@microsoft.com</strong>
                    </li>
                    <li><a href="/">User Settings</a></li>
                    <li><a href="https://www.youtube.com/watch?v=G7RgN9ijwE4" target="_blank">Log Out</a></li>

                  </ul>
                </zf-popup>
              </li>
            </ul>
          </div>
        </div>
      </div>
      <!-- /#header -->

      <div class="grid-block vertical">
        <div class="grid-content content-wrap">

          <!-- ui-view -->
          <div ui-view class="grid-content small-centered small-12 template-{{$state.current.name}}" id="main"></div>

          <!-- app footer -->
          <footer class="collapse shrink">
            <ul class="inline-list">
              <li>
                <a href="https://open.microsoft.com/" target="_blank"><img src="assets/images/microsoft.png" /></a>
              </li>
              <li><span><a href="https://github.com/azure/brigade" target="_blank">BRIGADE</a> is licensed under the The MIT License.</span></li>
              <li><a href="https://github.com/azure/brigade/releases" target="_blank">Changelog</a></li>
              <li><a href="https://github.com/azure/brigade/tree/master/docs" target="_blank">Documentation</a></li>
              <li><a href="https://github.com/azure/brigade/" target="_blank">Github</a></li>
            </ul>
          </footer>

          <div zf-modal="" id="basicModal" animation-in="slideInLeft" animation-out="slideOutRight">
            <a zf-close="" class="close-button">Ã—</a>
            <h3>Project Configuration</h3>
<pre>
/* global Job WaitGroup events */

function build(e) {
  // This is a Go project, so we want to set it up for Go.
  var gopath = "/go"

  // To set GOPATH correctly, we have to override the default
  // path that Brigade sets.
  var localPath = gopath + "/src/github.com/" + project.repo.name;


  // Create a new job
  var goBuild = new Job("brigade-test");

  // Since this is Go, we want a go runner.
  goBuild.image = "golang:1.8";

  // Set a few environment variables.
  goBuild.env = {
      "DEST_PATH": localPath,
      "GOPATH": gopath
  };

  // Run three tasks in order.
  goBuild.tasks = [
    "date",
    "echo Begin test-unit",
    "go get github.com/Masterminds/glide",
    "go get github.com/jteeuwen/go-bindata/...",
    // Need to move the source into GOPATH so vendor/ works as desired.
    "mkdir -p " + localPath,
    "mv /src/* " + localPath,
    "cd " + localPath,
    "glide install --strip-vendor",
    "make test-unit"
  ];

  var jsLint = new Job("brigade-js-build");

  jsLint.image = "technosophos/brigade-node:latest";
  jsLint.tasks = [
    "date",
    "echo Begin test-js",
    "cd /src",
    "npm install -g --quiet eslint",
    "make test-js"
  ];

  // Run both jobs in parallel, and wait for then both to finish.
  var waiter = new WaitGroup()

  waiter.add(jsLint)
  waiter.add(goBuild)
  waiter.run()
}

// Handle Push
events.push = build

// Handle Pull Request
events.pullRequest = build
</pre>
          </div>
          <!-- /modal -->

        </div>
      </div>

    </div>

  </div>
</body>
</html>